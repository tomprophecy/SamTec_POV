{
  "metainfo" : {
    "migrationVersions" : {
      "gemBuilderVersion" : "v1"
    },
    "functions" : { },
    "codeGenConfiguration" : {
      "editableConfig" : false,
      "plibVersion" : {
        "mavenVersion" : "8.0.25",
        "pyPiVersion" : "1.9.9"
      }
    },
    "id" : "test",
    "uri" : "pipelines/perpetual_inventory_details",
    "language" : "python",
    "fabricId" : "2460",
    "frontEndLanguage" : "python",
    "mode" : "batch",
    "udfs" : {
      "language" : "python",
      "udfs" : [ ],
      "functionPackageName" : "ayadavprophecyioteam.samtechpipelines.functions",
      "sharedFunctionPackageNames" : [ "prophecy.spark_abi.functions", "prophecy.spark_basic.functions", "prophecy.warehouse.functions" ],
      "initialCode" : "\n\ndef alteryxOutputColumns(all_columns, columns_to_drop):\n    conflicting_columns = [col.replace(\"in0_\", \"\").replace(\"in1_\", \"\") for col in all_columns]\n    conflicting_columns = set([x for x in conflicting_columns if conflicting_columns.count(x) > 1])\n\n    output_columns = []\n    for col_name in all_columns:\n        original_column_name = col_name.replace(\"in0_\", \"\").replace(\"in1_\", \"\")\n\n        if col_name in columns_to_drop:\n            continue\n        else:\n            if original_column_name in conflicting_columns and col_name.startswith(\"in1_\"):\n                output_columns.append(f\"`in1_{original_column_name}` AS `Right_{original_column_name}`\")\n            elif col_name.startswith(\"in1_\"):\n                output_columns.append(f\"`in1_{original_column_name}` AS `{original_column_name}`\")\n            elif col_name.startswith(\"in0_\"):\n                output_columns.append(f\"`in0_{original_column_name}` AS `{original_column_name}`\")\n            else:\n                output_columns.append(f\"`{original_column_name}` AS `{original_column_name}`\")\n\n    return output_columns\n\ndef textToColumns(exploded_df, input_column, num_cols, rootName, field_separator):\n    split_col_df = exploded_df.withColumn(\"splitCol\", call_spark_fcn(\"splitIntoMultipleColumnsUdf\", col(input_column), lit(field_separator), lit(num_cols)).alias(\"splitCol\"))\n\n    final_df = split_col_df\n    index = -1\n\n    output_schema_columns = [f\"{rootName}{i}\" for i in range(1, num_cols + 1)]\n\n    for column in output_schema_columns:\n        index += 1\n        final_df = final_df.withColumn(column, col(\"splitCol\")[index])\n\n    final_df = final_df.drop(\"splitCol\").drop(input_column)\n    return final_df\n\ndef transposeDataFrame(df, key_columns, data_columns):\n    unpivoted_cols = [col(column) for column in key_columns] + [lit(column).alias(\"Name\") for column in data_columns] + [col(column).alias(\"Value\") for column in data_columns]\n    return df.select(*unpivoted_cols)\n\n\n"
    },
    "configuration" : {
      "common" : {
        "type" : "record",
        "fields" : [ {
          "name" : "jdbcUrl_SamtecFacilitieswith",
          "kind" : {
            "type" : "string",
            "value" : "X:\\adw\\operations\\material management\\material reconciliation\\Samtec Facilities with Balances.yxdb"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "username_SamtecFacilitieswith",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "password_SamtecFacilitieswith",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "jdbcUrl_PerpetualInventoryDe",
          "kind" : {
            "type" : "string",
            "value" : "Perpetual Inventory Details.yxdb"
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "username_PerpetualInventoryDe",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        }, {
          "name" : "password_PerpetualInventoryDe",
          "kind" : {
            "type" : "string",
            "value" : ""
          },
          "optional" : false,
          "isWorkflowNodeConfiguration" : false,
          "isReferenced" : false
        } ]
      },
      "oldCommon" : {
        "type" : "record",
        "fields" : [ ]
      },
      "fabrics" : { },
      "instances" : { },
      "selected" : "default",
      "nonEditable" : [ ],
      "isSubscribedPipelineWithPipelineConfigs" : false
    },
    "sparkConf" : [ ],
    "hadoopConf" : [ ],
    "codeMode" : "sparse",
    "buildSystem" : "maven",
    "externalDependencies" : [ ],
    "dependentProjectExternalDependencies" : [ {
      "projectUID" : "19668",
      "projectName" : "ProphecySparkAbinitioPython",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "12654",
      "projectName" : "ProphecySparkBasicsPython",
      "externalDependencies" : [ ]
    }, {
      "projectUID" : "12655",
      "projectName" : "ProphecyWarehousePython",
      "externalDependencies" : [ ]
    } ],
    "isImported" : false,
    "interimMode" : "Full",
    "interimModeEnabled" : true,
    "visualCodeInterimMode" : "Disabled",
    "recordsLimit" : {
      "enabled" : false,
      "value" : 1000
    },
    "configurationVersion" : "v2"
  },
  "connections" : [ {
    "id" : "edge_1",
    "source" : "84",
    "sourcePort" : "84_Output",
    "target" : "108",
    "targetPort" : "108_Input"
  }, {
    "id" : "edge_2",
    "source" : "85",
    "sourcePort" : "85_Output",
    "target" : "109",
    "targetPort" : "109_Input"
  }, {
    "id" : "edge_3",
    "source" : "92",
    "sourcePort" : "92_Output",
    "target" : "95",
    "targetPort" : "95_Input"
  }, {
    "id" : "edge_4",
    "source" : "94",
    "sourcePort" : "94_Output26",
    "target" : "92",
    "targetPort" : "92_Input"
  }, {
    "id" : "edge_5",
    "source" : "95",
    "sourcePort" : "95_Output",
    "target" : "96",
    "targetPort" : "96_Input"
  }, {
    "id" : "edge_6",
    "source" : "96",
    "sourcePort" : "96_Output",
    "target" : "97",
    "targetPort" : "97_Input"
  }, {
    "id" : "edge_7",
    "source" : "103",
    "sourcePort" : "103_Output",
    "target" : "104",
    "targetPort" : "104_Input"
  }, {
    "id" : "edge_8",
    "source" : "104",
    "sourcePort" : "104_Output",
    "target" : "105",
    "targetPort" : "105_Input"
  }, {
    "id" : "edge_9",
    "source" : "41",
    "sourcePort" : "41_Output",
    "target" : "84",
    "targetPort" : "84_Input"
  }, {
    "id" : "edge_10",
    "source" : "44",
    "sourcePort" : "44_Output",
    "target" : "41",
    "targetPort" : "41_Input"
  }, {
    "id" : "edge_11",
    "source" : "50",
    "sourcePort" : "50_Output",
    "target" : "85",
    "targetPort" : "85_Input"
  }, {
    "id" : "edge_12",
    "source" : "53",
    "sourcePort" : "53_Output",
    "target" : "50",
    "targetPort" : "50_Input"
  }, {
    "id" : "edge_13",
    "source" : "57",
    "sourcePort" : "57_Output",
    "target" : "59",
    "targetPort" : "59_Input"
  }, {
    "id" : "edge_14",
    "source" : "58",
    "sourcePort" : "58_Output",
    "target" : "60",
    "targetPort" : "60_Targets"
  }, {
    "id" : "edge_15",
    "source" : "70",
    "sourcePort" : "70_Output",
    "target" : "60",
    "targetPort" : "60_Source"
  }, {
    "id" : "edge_16",
    "source" : "59",
    "sourcePort" : "59_Output",
    "target" : "58",
    "targetPort" : "58_Input"
  }, {
    "id" : "edge_17",
    "source" : "60",
    "sourcePort" : "60_Output",
    "target" : "61",
    "targetPort" : "61_Input"
  }, {
    "id" : "edge_18",
    "source" : "61",
    "sourcePort" : "61_True",
    "target" : "62",
    "targetPort" : "62_Input"
  }, {
    "id" : "edge_19",
    "source" : "66",
    "sourcePort" : "66_Output",
    "target" : "86",
    "targetPort" : "86_Input"
  }, {
    "id" : "edge_20",
    "source" : "100",
    "sourcePort" : "100_Output",
    "target" : "101",
    "targetPort" : "101_Input"
  }, {
    "id" : "edge_21",
    "source" : "98",
    "sourcePort" : "98_Output",
    "target" : "100",
    "targetPort" : "100_Input"
  }, {
    "id" : "edge_22",
    "source" : "26",
    "sourcePort" : "26_Output",
    "target" : "27",
    "targetPort" : "27_Input"
  }, {
    "id" : "edge_23",
    "source" : "27",
    "sourcePort" : "27_Output",
    "target" : "28",
    "targetPort" : "28_Input"
  }, {
    "id" : "edge_24",
    "source" : "27",
    "sourcePort" : "27_Output",
    "target" : "29",
    "targetPort" : "29_Input"
  }, {
    "id" : "edge_25",
    "source" : "28",
    "sourcePort" : "28_Output",
    "target" : "17",
    "targetPort" : "17_Input"
  }, {
    "id" : "edge_26",
    "source" : "28",
    "sourcePort" : "28_Output",
    "target" : "39",
    "targetPort" : "39_Input"
  }, {
    "id" : "edge_27",
    "source" : "28",
    "sourcePort" : "28_Output",
    "target" : "48",
    "targetPort" : "48_Input"
  }, {
    "id" : "edge_28",
    "source" : "28",
    "sourcePort" : "28_Output",
    "target" : "70",
    "targetPort" : "70_Input"
  }, {
    "id" : "edge_29",
    "source" : "23",
    "sourcePort" : "23_True",
    "target" : "24",
    "targetPort" : "24_Input"
  }, {
    "id" : "edge_30",
    "source" : "24",
    "sourcePort" : "24_Output",
    "target" : "42",
    "targetPort" : "42_Input"
  }, {
    "id" : "edge_31",
    "source" : "24",
    "sourcePort" : "24_Output",
    "target" : "51",
    "targetPort" : "51_Input"
  }, {
    "id" : "edge_32",
    "source" : "24",
    "sourcePort" : "24_Output",
    "target" : "65",
    "targetPort" : "65_Input"
  }, {
    "id" : "edge_33",
    "source" : "106",
    "sourcePort" : "106_Output",
    "target" : "107",
    "targetPort" : "107_Input"
  }, {
    "id" : "edge_34",
    "source" : "107",
    "sourcePort" : "107_Output",
    "target" : "23",
    "targetPort" : "23_Input"
  }, {
    "id" : "edge_35",
    "source" : "33",
    "sourcePort" : "33_Output",
    "target" : "37",
    "targetPort" : "37_Input"
  }, {
    "id" : "edge_36",
    "source" : "37",
    "sourcePort" : "37_Output",
    "target" : "74",
    "targetPort" : "74_Input"
  }, {
    "id" : "edge_37",
    "source" : "37",
    "sourcePort" : "37_Output",
    "target" : "77",
    "targetPort" : "77_Input"
  }, {
    "id" : "edge_38",
    "source" : "37",
    "sourcePort" : "37_Output",
    "target" : "80",
    "targetPort" : "80_Input"
  }, {
    "id" : "edge_39",
    "source" : "11",
    "sourcePort" : "11_Output",
    "target" : "15",
    "targetPort" : "15_Input"
  }, {
    "id" : "edge_40",
    "source" : "12",
    "sourcePort" : "12_Output",
    "target" : "13",
    "targetPort" : "13_Input"
  }, {
    "id" : "edge_41",
    "source" : "13",
    "sourcePort" : "13_Output",
    "target" : "14",
    "targetPort" : "14_Input"
  }, {
    "id" : "edge_42",
    "source" : "14",
    "sourcePort" : "14_Output",
    "target" : "16",
    "targetPort" : "16_Targets"
  }, {
    "id" : "edge_43",
    "source" : "17",
    "sourcePort" : "17_Output",
    "target" : "16",
    "targetPort" : "16_Source"
  }, {
    "id" : "edge_44",
    "source" : "15",
    "sourcePort" : "15_True",
    "target" : "12",
    "targetPort" : "12_Input"
  }, {
    "id" : "edge_45",
    "source" : "40_fileName",
    "sourcePort" : "dlGmb4JygKEoXNFH00E5i",
    "target" : "40",
    "targetPort" : "40_Input"
  }, {
    "id" : "edge_46",
    "source" : "39",
    "sourcePort" : "39_Output",
    "target" : "40_fileName",
    "targetPort" : "vop9g8FENP65unHV8mRtt"
  }, {
    "id" : "edge_47",
    "source" : "49_fileName",
    "sourcePort" : "VtibWpESshDcPylWGLu7Z",
    "target" : "49",
    "targetPort" : "49_Input"
  }, {
    "id" : "edge_48",
    "source" : "48",
    "sourcePort" : "48_Output",
    "target" : "49_fileName",
    "targetPort" : "g9Q7cOCTy3unQPmtLJaNh"
  }, {
    "id" : "edge_49",
    "source" : "63_fileName",
    "sourcePort" : "FTg0030vqpbk9j-gNwS-F",
    "target" : "63",
    "targetPort" : "63_Input"
  }, {
    "id" : "edge_50",
    "source" : "62",
    "sourcePort" : "62_Output",
    "target" : "63_fileName",
    "targetPort" : "izlAvaQo4MOK8XMVQvB2I"
  }, {
    "id" : "edge_51",
    "source" : "97",
    "sourcePort" : "97_Output",
    "target" : "99_inner",
    "targetPort" : "fUjpbRWK1ND4EWyfyyxvg"
  }, {
    "id" : "edge_52",
    "source" : "101",
    "sourcePort" : "101_Output",
    "target" : "99_inner",
    "targetPort" : "3TUPB-5K2OhoM8BMunRbq"
  }, {
    "id" : "edge_53",
    "source" : "99_inner",
    "sourcePort" : "_B-p6q1qF02yJJrK8Tc7l",
    "target" : "103",
    "targetPort" : "103_Input"
  }, {
    "id" : "edge_54",
    "source" : "40",
    "sourcePort" : "40_Output",
    "target" : "43_inner",
    "targetPort" : "Eq51AcpkeVD6NbDq-Etkq"
  }, {
    "id" : "edge_55",
    "source" : "42",
    "sourcePort" : "42_Output",
    "target" : "43_inner",
    "targetPort" : "egiHiuFGVVCCtQhsklNpM"
  }, {
    "id" : "edge_56",
    "source" : "74",
    "sourcePort" : "74_Output",
    "target" : "75_inner",
    "targetPort" : "ZXONIy7E8fdhs_up0YXPD"
  }, {
    "id" : "edge_57",
    "source" : "43_inner",
    "sourcePort" : "gz4yUY7kHMB5QHWrZAm07",
    "target" : "75_inner",
    "targetPort" : "ZQVOaRB8Cck0wGN8ZZzrK"
  }, {
    "id" : "edge_58",
    "source" : "75_inner",
    "sourcePort" : "tNdbIppU3QTWfx901sclP",
    "target" : "44",
    "targetPort" : "44_Input"
  }, {
    "id" : "edge_59",
    "source" : "49",
    "sourcePort" : "49_Output",
    "target" : "52_inner",
    "targetPort" : "4P9b4hcNbcGhQZI6-iOuh"
  }, {
    "id" : "edge_60",
    "source" : "51",
    "sourcePort" : "51_Output",
    "target" : "52_inner",
    "targetPort" : "B8IR5QZASO5cBEMd5x2Um"
  }, {
    "id" : "edge_61",
    "source" : "77",
    "sourcePort" : "77_Output",
    "target" : "76_inner",
    "targetPort" : "3GgHLqhZ6Vup4HzfTlHBj"
  }, {
    "id" : "edge_62",
    "source" : "52_inner",
    "sourcePort" : "QGajk0voo0PLdh6SqxL8L",
    "target" : "76_inner",
    "targetPort" : "IpAOesq6xw-8-Q27NSwoQ"
  }, {
    "id" : "edge_63",
    "source" : "76_inner",
    "sourcePort" : "nzE7ip1G71E7qBV4nhD4B",
    "target" : "53",
    "targetPort" : "53_Input"
  }, {
    "id" : "edge_64",
    "source" : "63",
    "sourcePort" : "63_Output",
    "target" : "64_inner",
    "targetPort" : "HW1FOsluNdvUEsebPOjmd"
  }, {
    "id" : "edge_65",
    "source" : "65",
    "sourcePort" : "65_Output",
    "target" : "64_inner",
    "targetPort" : "dHrqlCwxV9yCKZdIxJE-V"
  }, {
    "id" : "edge_66",
    "source" : "80",
    "sourcePort" : "80_Output",
    "target" : "81_inner",
    "targetPort" : "pLxuc287c_wGBOsfJcwus"
  }, {
    "id" : "edge_67",
    "source" : "64_inner",
    "sourcePort" : "A0OUK5CM9PqCiRUvJ3VpA",
    "target" : "81_inner",
    "targetPort" : "BldIpn3LbKZemkeOklw4F"
  }, {
    "id" : "edge_68",
    "source" : "81_inner",
    "sourcePort" : "EvGoGLJlBL_iAi4lTnjar",
    "target" : "66",
    "targetPort" : "66_Input"
  }, {
    "id" : "edge_69",
    "source" : "108",
    "sourcePort" : "108_Output",
    "target" : "88_left",
    "targetPort" : "U4QiShm-cxD96GbsgHXaN"
  }, {
    "id" : "edge_70",
    "source" : "109",
    "sourcePort" : "109_Output",
    "target" : "88_left",
    "targetPort" : "jmH3AfjAKRK_Jd_XSow-G"
  }, {
    "id" : "edge_71",
    "source" : "86",
    "sourcePort" : "86_Output",
    "target" : "91_left",
    "targetPort" : "GuB1lAVrUrGsNHfjvV-Eh"
  }, {
    "id" : "edge_72",
    "source" : "88_left",
    "sourcePort" : "a7zBPDKpzvf93lXUGFGdZ",
    "target" : "91_left",
    "targetPort" : "ihgO0zenthCDbFBkQCNtq"
  }, {
    "id" : "edge_73",
    "source" : "91_left",
    "sourcePort" : "x8Yz4qO3wg1_Khu9CDT8T",
    "target" : "94",
    "targetPort" : "94_Input2"
  }, {
    "id" : "edge_74",
    "source" : "57_createData",
    "sourcePort" : "ieQ77durax03tMr9LmnLL",
    "target" : "57",
    "targetPort" : "IwLjCIROf_RqO6tpSvFIB"
  }, {
    "id" : "edge_75",
    "source" : "11_createData",
    "sourcePort" : "CA2WDdb9IKgYPbGqcI1Ge",
    "target" : "11",
    "targetPort" : "ifI5SJY84Um9az7L5xAOS"
  } ],
  "processes" : {
    "98" : {
      "id" : "98",
      "component" : "Source",
      "metadata" : {
        "label" : "AccountingTransactio_2",
        "slug" : "AccountingTransactio",
        "x" : 3980,
        "y" : 1860,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "98_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/AccountingTransactio_2"
      }
    },
    "57_createData" : {
      "id" : "57_createData",
      "component" : "Source",
      "metadata" : {
        "label" : "Transactions_createData_2",
        "slug" : "Transactions_createData",
        "x" : 420,
        "y" : 2060,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "ieQ77durax03tMr9LmnLL",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Transactions_createData_2"
      }
    },
    "12" : {
      "id" : "12",
      "component" : "Reformat",
      "metadata" : {
        "label" : "AlteryxSelect_12",
        "slug" : "AlteryxSelect_12",
        "x" : 620,
        "y" : 20,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "12_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "fileName",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "12_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "FileName",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"FileName\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "66" : {
      "id" : "66",
      "component" : "Reformat",
      "metadata" : {
        "label" : "AlteryxSelect_66",
        "slug" : "AlteryxSelect_66",
        "x" : 2920,
        "y" : 1720,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "66_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Quantity",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionId",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Note",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DateTransacted",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactedBy",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "66_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Plant\")"
          },
          "description" : ""
        }, {
          "target" : "Quantity",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Quantity\")"
          },
          "description" : ""
        }, {
          "target" : "TransactionId",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"TransactionId\")"
          },
          "description" : ""
        }, {
          "target" : "TransactionType",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"TransactionType\")"
          },
          "description" : ""
        }, {
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"PartNumber\")"
          },
          "description" : ""
        }, {
          "target" : "Note",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Note\")"
          },
          "description" : ""
        }, {
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Facility\")"
          },
          "description" : ""
        }, {
          "target" : "DateTransacted",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"DateTransacted\")"
          },
          "description" : ""
        }, {
          "target" : "TransactedBy",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"TransactedBy\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "51" : {
      "id" : "51",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Facilities",
        "slug" : "Facilities",
        "x" : 1420,
        "y" : 1220,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "51_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "51_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Facility\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "84" : {
      "id" : "84",
      "component" : "Reformat",
      "metadata" : {
        "label" : "OpeningBalance",
        "slug" : "OpeningBalance",
        "x" : 2720,
        "y" : 640,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "84_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "OpeningBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "84_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Facility\")"
          },
          "description" : ""
        }, {
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Plant\")"
          },
          "description" : ""
        }, {
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"PartNumber\")"
          },
          "description" : ""
        }, {
          "target" : "OpeningBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"OpeningBalance\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "81_inner" : {
      "id" : "81_inner",
      "component" : "Join",
      "metadata" : {
        "label" : "Join_81_inner",
        "slug" : "Join_81_inner",
        "x" : 2720,
        "y" : 1720,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "BldIpn3LbKZemkeOklw4F",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Quantity",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionId",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Note",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DateTransacted",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactedBy",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "pLxuc287c_wGBOsfJcwus",
          "slug" : "in1",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "EvGoGLJlBL_iAi4lTnjar",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.PartNumber\") == col(\"in1.PartNumber\")"
          },
          "joinType" : "inner"
        } ],
        "expressions" : [ {
          "_row_id" : "1944407237",
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Plant\")"
          },
          "description" : ""
        }, {
          "_row_id" : "484078675",
          "target" : "Quantity",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Quantity\")"
          },
          "description" : ""
        }, {
          "_row_id" : "734486573",
          "target" : "TransactionId",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.TransactionId\")"
          },
          "description" : ""
        }, {
          "_row_id" : "247063937",
          "target" : "TransactionType",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.TransactionType\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1118625110",
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.PartNumber\")"
          },
          "description" : ""
        }, {
          "_row_id" : "393528174",
          "target" : "Note",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Note\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1325439326",
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Facility\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1854869352",
          "target" : "DateTransacted",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.DateTransacted\")"
          },
          "description" : ""
        }, {
          "_row_id" : "2136331029",
          "target" : "TransactedBy",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.TransactedBy\")"
          },
          "description" : ""
        } ],
        "hints" : [ {
          "id" : "BldIpn3LbKZemkeOklw4F",
          "alias" : "in0",
          "hintType" : "none",
          "propagateColumns" : false
        }, {
          "id" : "pLxuc287c_wGBOsfJcwus",
          "alias" : "in1",
          "hintType" : "none",
          "propagateColumns" : false
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "whereClause" : null,
        "headAlias" : "in0"
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Join",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "100" : {
      "id" : "100",
      "component" : "Reformat",
      "metadata" : {
        "label" : "AlteryxSelect_100",
        "slug" : "AlteryxSelect_100",
        "x" : 4180,
        "y" : 1860,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "100_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Base Transaction Type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Accounting Transaction Type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "100_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "Base Transaction Type",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"`Base Transaction Type`\")"
          },
          "description" : ""
        }, {
          "target" : "Accounting Transaction Type",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"`Accounting Transaction Type`\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "23" : {
      "id" : "23",
      "component" : "Filter",
      "metadata" : {
        "label" : "Filter_23",
        "slug" : "Filter_23",
        "x" : 1020,
        "y" : 1180,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "23_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "23_True",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "format" : "python",
          "expression" : "array_contains(array(lit(\"SAMTEC USA\")), col(\"Facility\").cast(StringType()))"
        }
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Filter",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "62" : {
      "id" : "62",
      "component" : "Reformat",
      "metadata" : {
        "label" : "AlteryxSelect_62",
        "slug" : "AlteryxSelect_62",
        "x" : 1680,
        "y" : 2080,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "62_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "FileName",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "FileDate",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "StartDate",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "EndDate",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "62_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "FileDate",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"FileDate\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "77" : {
      "id" : "77",
      "component" : "Reformat",
      "metadata" : {
        "label" : "PartNumber",
        "slug" : "PartNumber",
        "x" : 1680,
        "y" : 1620,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "77_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "77_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"PartNumber\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "40" : {
      "id" : "40",
      "component" : "Script",
      "metadata" : {
        "label" : "DynamicInput_40",
        "slug" : "DynamicInput_40",
        "x" : 1420,
        "y" : 720,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "40_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "StartDate",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "fileName",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "40_Output",
          "slug" : "out0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WIPOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "BentecOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WarehouseOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Timestamp",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ConsignedOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "\n\n\ndef read_file(file_name):\n    return spark.read.format(\"csv\").option(\"header\", \"true\").load(file_name)\n\ndata_frames = [read_file(row['fileName']) for row in df.select('fileName').collect()]\n\nout0 = reduce(DataFrame.union, data_frames)\n",
        "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> DataFrame:",
        "scriptMethodFooter" : "return out0"
      }
    },
    "63_fileName" : {
      "id" : "63_fileName",
      "component" : "SchemaTransform",
      "metadata" : {
        "label" : "DynamicInput_63_fileName",
        "slug" : "DynamicInput_63_fileName",
        "x" : 2000,
        "y" : 2080,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "izlAvaQo4MOK8XMVQvB2I",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "FileDate",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "FTg0030vqpbk9j-gNwS-F",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "transformations" : [ {
          "AddRule" : {
            "expression" : {
              "format" : "scala",
              "expression" : ""
            },
            "paramErrors" : [ ]
          },
          "DropColumn" : {
            "sourceColumn" : ""
          },
          "kind" : "AddReplaceColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "fileName",
            "expression" : {
              "format" : "python",
              "expression" : "concat(lit(\"X:\\\\adw\\\\operations\\\\material management\\\\material reconciliation\\\\transactions\\\\2016-06-01.yxdb\"), col(\"FileDate\"))"
            }
          }
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "75_inner" : {
      "id" : "75_inner",
      "component" : "Join",
      "metadata" : {
        "label" : "Join_75_inner",
        "slug" : "Join_75_inner",
        "x" : 2000,
        "y" : 1320,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "ZQVOaRB8Cck0wGN8ZZzrK",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Timestamp",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WIPOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "BentecOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WarehouseOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ConsignedOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "ZXONIy7E8fdhs_up0YXPD",
          "slug" : "in1",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "tNdbIppU3QTWfx901sclP",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.PartNumber\") == col(\"in1.PartNumber\")"
          },
          "joinType" : "inner"
        } ],
        "expressions" : [ {
          "_row_id" : "263150290",
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Plant\")"
          },
          "description" : ""
        }, {
          "_row_id" : "258485290",
          "target" : "Timestamp",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Timestamp\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1587301310",
          "target" : "WIPOnHandBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.WIPOnHandBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "996024108",
          "target" : "BentecOnHandBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.BentecOnHandBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1338253224",
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.PartNumber\")"
          },
          "description" : ""
        }, {
          "_row_id" : "856960473",
          "target" : "WarehouseOnHandBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.WarehouseOnHandBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "916129993",
          "target" : "ConsignedOnHandBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.ConsignedOnHandBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1127315802",
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Facility\")"
          },
          "description" : ""
        } ],
        "hints" : [ {
          "id" : "ZQVOaRB8Cck0wGN8ZZzrK",
          "alias" : "in0",
          "hintType" : "none",
          "propagateColumns" : false
        }, {
          "id" : "ZXONIy7E8fdhs_up0YXPD",
          "alias" : "in1",
          "hintType" : "none",
          "propagateColumns" : false
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "whereClause" : null,
        "headAlias" : "in0"
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Join",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "15" : {
      "id" : "15",
      "component" : "Filter",
      "metadata" : {
        "label" : "Filter_15",
        "slug" : "Filter_15",
        "x" : 420,
        "y" : 20,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "15_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "fileName",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "15_True",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "format" : "python",
          "expression" : "col(\"FileName\").cast(StringType()) > lit(\"2016-05-28.yxdb\")"
        }
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Filter",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "11" : {
      "id" : "11",
      "component" : "SchemaTransform",
      "metadata" : {
        "label" : "Balances",
        "slug" : "Balances",
        "x" : 220,
        "y" : 20,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "ifI5SJY84Um9az7L5xAOS",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "seq",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "11_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "transformations" : [ {
          "AddRule" : {
            "expression" : {
              "format" : "scala",
              "expression" : ""
            },
            "paramErrors" : [ ]
          },
          "DropColumn" : {
            "sourceColumn" : ""
          },
          "kind" : "AddReplaceColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "fileNameArray",
            "expression" : {
              "format" : "python",
              "expression" : "call_spark_fcn(\"directory_listing\", lit(\"X:\\ADW\\Operations\\Material Management\\Material Reconciliation\\Balances\"), lit(\"\"))"
            }
          }
        }, {
          "AddRule" : {
            "expression" : {
              "format" : "scala",
              "expression" : ""
            },
            "paramErrors" : [ ]
          },
          "DropColumn" : {
            "sourceColumn" : ""
          },
          "kind" : "AddReplaceColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "fileName",
            "expression" : {
              "format" : "python",
              "expression" : "explode(col(\"fileNameArray\"))"
            }
          }
        }, {
          "AddRule" : {
            "expression" : {
              "format" : "scala",
              "expression" : ""
            },
            "paramErrors" : [ ]
          },
          "DropColumn" : {
            "sourceColumn" : "fileNameArray"
          },
          "kind" : "DropColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "",
            "expression" : {
              "format" : "scala",
              "expression" : ""
            }
          }
        }, {
          "AddRule" : {
            "expression" : {
              "format" : "scala",
              "expression" : ""
            },
            "paramErrors" : [ ]
          },
          "DropColumn" : {
            "sourceColumn" : "seq"
          },
          "kind" : "DropColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "",
            "expression" : {
              "format" : "scala",
              "expression" : ""
            }
          }
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "104" : {
      "id" : "104",
      "component" : "OrderBy",
      "metadata" : {
        "label" : "Sort_104",
        "slug" : "Sort_104",
        "x" : 4980,
        "y" : 1760,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "104_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "OpeningBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ClosingBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionId",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "SystemType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "AccountingType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Quantity",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "RollingBalance",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DateTransacted",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactedBy",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Note",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "104_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "orders" : [ {
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Facility\")"
          },
          "sortType" : "asc"
        }, {
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Plant\")"
          },
          "sortType" : "asc"
        }, {
          "expression" : {
            "format" : "python",
            "expression" : "col(\"PartNumber\")"
          },
          "sortType" : "asc"
        }, {
          "expression" : {
            "format" : "python",
            "expression" : "col(\"DateTransacted\")"
          },
          "sortType" : "asc"
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/OrderBy",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "44" : {
      "id" : "44",
      "component" : "SchemaTransform",
      "metadata" : {
        "label" : "OpeningBalance",
        "slug" : "OpeningBalance",
        "x" : 2200,
        "y" : 1320,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "44_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Timestamp",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WIPOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "BentecOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WarehouseOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ConsignedOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "44_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "transformations" : [ {
          "AddRule" : {
            "expression" : {
              "format" : "scala",
              "expression" : ""
            },
            "paramErrors" : [ ]
          },
          "DropColumn" : {
            "sourceColumn" : ""
          },
          "kind" : "AddReplaceColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "OpeningBalance",
            "expression" : {
              "format" : "python",
              "expression" : "(((col(\"WarehouseOnHandBalance\") + col(\"BentecOnHandBalance\")) + col(\"WIPOnHandBalance\")) + col(\"ConsignedOnHandBalance\"))"
            }
          }
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "33" : {
      "id" : "33",
      "component" : "Script",
      "metadata" : {
        "label" : "TextInput_33",
        "slug" : "TextInput_33",
        "x" : 1220,
        "y" : 1580,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "33_Output",
          "slug" : "out0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "\n\ncolNames = [ \"PartNumber\" ]\ndata = [ [ \"BW-44WB7-SPC\" ] ]\n\n\nrows = [Row(*row) for row in data]\n\nschema = StructType([\n    StructField(\"PartNumber\", StringType(), nullable=True)\n])\n\nout0 = spark.createDataFrame(rows, schema)\n\n",
        "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> DataFrame:",
        "scriptMethodFooter" : "return out0"
      }
    },
    "26" : {
      "id" : "26",
      "component" : "Script",
      "metadata" : {
        "label" : "TextInput_26",
        "slug" : "TextInput_26",
        "x" : 420,
        "y" : 440,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "26_Output",
          "slug" : "out0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "StartDate",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "EndDate",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "\n\ncolNames = [ \"StartDate\" , \"EndDate\" ]\ndata = [ [ \"2020-09-02\" , \"2020-09-02\" ] ]\n\n\nrows = [Row(*row) for row in data]\n\nschema = StructType([\n    StructField(\"StartDate\", StringType(), nullable=True),\n StructField(\"EndDate\", StringType(), nullable=True)\n])\n\nout0 = spark.createDataFrame(rows, schema)\n\n",
        "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> DataFrame:",
        "scriptMethodFooter" : "return out0"
      }
    },
    "50" : {
      "id" : "50",
      "component" : "Reformat",
      "metadata" : {
        "label" : "AlteryxSelect_50",
        "slug" : "AlteryxSelect_50",
        "x" : 2520,
        "y" : 440,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "50_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Timestamp",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WIPOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "BentecOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WarehouseOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ConsignedOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ClosingBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "50_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Facility\")"
          },
          "description" : ""
        }, {
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Plant\")"
          },
          "description" : ""
        }, {
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"PartNumber\")"
          },
          "description" : ""
        }, {
          "target" : "ClosingBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"ClosingBalance\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "37" : {
      "id" : "37",
      "component" : "Reformat",
      "metadata" : {
        "label" : "AlteryxSelect_37",
        "slug" : "AlteryxSelect_37",
        "x" : 1420,
        "y" : 1580,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "37_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "37_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"PartNumber\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "61" : {
      "id" : "61",
      "component" : "Filter",
      "metadata" : {
        "label" : "DateFilter",
        "slug" : "DateFilter",
        "x" : 1420,
        "y" : 2080,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "61_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "FileName",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "FileDate",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "StartDate",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "EndDate",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "61_True",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "format" : "python",
          "expression" : "(col(\"FileDate\") >= col(\"StartDate\")) & (col(\"FileDate\") < col(\"EndDate\"))"
        }
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Filter",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "107" : {
      "id" : "107",
      "component" : "Reformat",
      "metadata" : {
        "label" : "AlteryxSelect_107",
        "slug" : "AlteryxSelect_107",
        "x" : 820,
        "y" : 1180,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "107_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "VALUE",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "NAME",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "107_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"VALUE\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "91_left" : {
      "id" : "91_left",
      "component" : "Join",
      "metadata" : {
        "label" : "Join_91_left_UnionFullOuter",
        "slug" : "Join_91_left_UnionFullOuter",
        "x" : 3380,
        "y" : 1660,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "ihgO0zenthCDbFBkQCNtq",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ClosingBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "OpeningBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "GuB1lAVrUrGsNHfjvV-Eh",
          "slug" : "in1",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactedBy",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DateTransacted",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Note",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionId",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Quantity",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "x8Yz4qO3wg1_Khu9CDT8T",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "format" : "python",
            "expression" : "((col(\"in0.Facility\") == col(\"in1.Facility\")) & (col(\"in0.Plant\") == col(\"in1.Plant\"))) & (col(\"in0.PartNumber\") == col(\"in1.PartNumber\"))"
          },
          "joinType" : "fullouter"
        } ],
        "expressions" : [ {
          "_row_id" : "1536965058",
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Plant\")"
          },
          "description" : ""
        }, {
          "_row_id" : "2044768559",
          "target" : "Quantity",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in1.Quantity\")"
          },
          "description" : ""
        }, {
          "_row_id" : "919063972",
          "target" : "ClosingBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.ClosingBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1757837942",
          "target" : "TransactionId",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in1.TransactionId\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1735654180",
          "target" : "TransactionType",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in1.TransactionType\")"
          },
          "description" : ""
        }, {
          "_row_id" : "874801796",
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.PartNumber\")"
          },
          "description" : ""
        }, {
          "_row_id" : "742921400",
          "target" : "Note",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in1.Note\")"
          },
          "description" : ""
        }, {
          "_row_id" : "2046346958",
          "target" : "OpeningBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.OpeningBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1626248925",
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Facility\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1243746100",
          "target" : "DateTransacted",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in1.DateTransacted\")"
          },
          "description" : ""
        }, {
          "_row_id" : "382430512",
          "target" : "TransactedBy",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in1.TransactedBy\")"
          },
          "description" : ""
        } ],
        "hints" : [ {
          "id" : "ihgO0zenthCDbFBkQCNtq",
          "alias" : "in0",
          "hintType" : "none",
          "propagateColumns" : false
        }, {
          "id" : "GuB1lAVrUrGsNHfjvV-Eh",
          "alias" : "in1",
          "hintType" : "none",
          "propagateColumns" : false
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "whereClause" : null,
        "headAlias" : "in0"
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Join",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "13" : {
      "id" : "13",
      "component" : "SchemaTransform",
      "metadata" : {
        "label" : "DatefromFileName",
        "slug" : "DatefromFileName",
        "x" : 820,
        "y" : 20,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "13_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "FileName",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "13_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "transformations" : [ {
          "AddRule" : {
            "expression" : {
              "format" : "scala",
              "expression" : ""
            },
            "paramErrors" : [ ]
          },
          "DropColumn" : {
            "sourceColumn" : ""
          },
          "kind" : "AddReplaceColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "FileDate",
            "expression" : {
              "format" : "python",
              "expression" : "regexp_replace(col(\"FileName\"), \".yxdb\", \"\")"
            }
          }
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "24" : {
      "id" : "24",
      "component" : "Reformat",
      "metadata" : {
        "label" : "AlteryxSelect_24",
        "slug" : "AlteryxSelect_24",
        "x" : 1220,
        "y" : 1180,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "24_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "24_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Facility\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "94" : {
      "id" : "94",
      "component" : "Script",
      "metadata" : {
        "label" : "yxmc_94",
        "slug" : "yxmc_94",
        "x" : 3580,
        "y" : 1660,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "94_Input2",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Quantity",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ClosingBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionId",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Note",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "OpeningBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DateTransacted",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactedBy",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "94_Output26",
          "slug" : "out0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Quantity",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Note",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ClosingBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactedBy",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DateTransacted",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionId",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "OpeningBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "\n\n\ndef clean_columns(df, columns_to_clean):\n    cleaned_df = df\n\n    for column in columns_to_clean:\n        column_type = df.schema[column].dataType\n        if column_type == \"string\":\n            cleaned_df = cleaned_df.withColumn(column, when(isnull(col(column)), \"\").otherwise(col(column)))\n        elif column_type == \"integer\":\n            cleaned_df = cleaned_df.withColumn(column, when(isnull(col(column)), 0).otherwise(col(column)))\n\n    return cleaned_df\n        \n\n\ndef cleanse_data_frame(df: DataFrame) -> DataFrame:\n        cleansed_df = df\n\n        # Iterate over each column\n        for col_name in df.columns:\n            transformed_col = col(col_name)\n            # Apply cleansing operations based on the boolean flags\n            transformed_col = trim(transformed_col)\n            \n            \n            \n            \n            \n            # Replace the original column with the transformed column\n            cleansed_df = cleansed_df.withColumn(col_name, transformed_col)\n\n        return cleansed_df\n\n\nout2 = in0\nout1 = clean_columns(out2, [\"OpeningBalance\",\"ClosingBalance\",\"Quantity\"])\nout0 = cleanse_data_frame(out1)\n",
        "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> DataFrame:",
        "scriptMethodFooter" : "return out0"
      }
    },
    "16" : {
      "id" : "16",
      "component" : "Join",
      "metadata" : {
        "label" : "AppendFields_16",
        "slug" : "AppendFields_16",
        "x" : 1220,
        "y" : 520,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "16_Targets",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "FirstDate",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "LastDate",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "16_Source",
          "slug" : "in1",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "StartDate",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "EndDate",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "DIIVs4OyIAwIiGXNlMK9J",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "format" : "python",
            "expression" : "lit(1) == lit(1).cast(IntegerType())"
          },
          "joinType" : "inner"
        } ],
        "expressions" : [ {
          "_row_id" : "1993444150",
          "target" : "FirstDate",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.FirstDate\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1825113840",
          "target" : "LastDate",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.LastDate\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1615138482",
          "target" : "StartDate",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in1.StartDate\")"
          },
          "description" : ""
        }, {
          "_row_id" : "699399704",
          "target" : "EndDate",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in1.EndDate\")"
          },
          "description" : ""
        } ],
        "hints" : [ {
          "id" : "16_Targets",
          "alias" : "in0",
          "hintType" : "none",
          "propagateColumns" : false
        }, {
          "id" : "16_Source",
          "alias" : "in1",
          "hintType" : "none",
          "propagateColumns" : false
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "whereClause" : null,
        "headAlias" : "in0"
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Join",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "103" : {
      "id" : "103",
      "component" : "Reformat",
      "metadata" : {
        "label" : "AlteryxSelect_103",
        "slug" : "AlteryxSelect_103",
        "x" : 4780,
        "y" : 1760,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "103_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Quantity",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ClosingBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionId",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Accounting Transaction Type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "RollingBalance",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Note",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "OpeningBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DateTransacted",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactedBy",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "103_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Facility\")"
          },
          "description" : ""
        }, {
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Plant\")"
          },
          "description" : ""
        }, {
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"PartNumber\")"
          },
          "description" : ""
        }, {
          "target" : "OpeningBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"OpeningBalance\")"
          },
          "description" : ""
        }, {
          "target" : "ClosingBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"ClosingBalance\")"
          },
          "description" : ""
        }, {
          "target" : "TransactionId",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"TransactionId\")"
          },
          "description" : ""
        }, {
          "target" : "SystemType",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"TransactionType\")"
          },
          "description" : ""
        }, {
          "target" : "AccountingType",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"`Accounting Transaction Type`\")"
          },
          "description" : ""
        }, {
          "target" : "Quantity",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Quantity\")"
          },
          "description" : ""
        }, {
          "target" : "RollingBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"RollingBalance\")"
          },
          "description" : ""
        }, {
          "target" : "DateTransacted",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"DateTransacted\")"
          },
          "description" : ""
        }, {
          "target" : "TransactedBy",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"TransactedBy\")"
          },
          "description" : ""
        }, {
          "target" : "Note",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Note\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "52_inner" : {
      "id" : "52_inner",
      "component" : "Join",
      "metadata" : {
        "label" : "Join_52_inner",
        "slug" : "Join_52_inner",
        "x" : 1680,
        "y" : 420,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "4P9b4hcNbcGhQZI6-iOuh",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WIPOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "BentecOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WarehouseOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Timestamp",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ConsignedOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "B8IR5QZASO5cBEMd5x2Um",
          "slug" : "in1",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "QGajk0voo0PLdh6SqxL8L",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Facility\") == col(\"in1.Facility\")"
          },
          "joinType" : "inner"
        } ],
        "expressions" : [ {
          "_row_id" : "512394492",
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Plant\")"
          },
          "description" : ""
        }, {
          "_row_id" : "807849037",
          "target" : "Timestamp",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Timestamp\")"
          },
          "description" : ""
        }, {
          "_row_id" : "2037436459",
          "target" : "WIPOnHandBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.WIPOnHandBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "740653247",
          "target" : "BentecOnHandBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.BentecOnHandBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1726270138",
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.PartNumber\")"
          },
          "description" : ""
        }, {
          "_row_id" : "722431132",
          "target" : "WarehouseOnHandBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.WarehouseOnHandBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1238674447",
          "target" : "ConsignedOnHandBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.ConsignedOnHandBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "482466940",
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Facility\")"
          },
          "description" : ""
        } ],
        "hints" : [ {
          "id" : "4P9b4hcNbcGhQZI6-iOuh",
          "alias" : "in0",
          "hintType" : "none",
          "propagateColumns" : false
        }, {
          "id" : "B8IR5QZASO5cBEMd5x2Um",
          "alias" : "in1",
          "hintType" : "none",
          "propagateColumns" : false
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "whereClause" : null,
        "headAlias" : "in0"
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Join",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "59" : {
      "id" : "59",
      "component" : "Reformat",
      "metadata" : {
        "label" : "AlteryxSelect_59",
        "slug" : "AlteryxSelect_59",
        "x" : 820,
        "y" : 2060,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "59_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "fileName",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "59_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "FileName",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"FileName\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "48" : {
      "id" : "48",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Dates",
        "slug" : "Dates",
        "x" : 1020,
        "y" : 320,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "48_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "StartDate",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "EndDate",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "48_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "EndDate",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"EndDate\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "64_inner" : {
      "id" : "64_inner",
      "component" : "Join",
      "metadata" : {
        "label" : "Join_64_inner",
        "slug" : "Join_64_inner",
        "x" : 2520,
        "y" : 940,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "HW1FOsluNdvUEsebPOjmd",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Quantity",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Note",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactedBy",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DateTransacted",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionId",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "dHrqlCwxV9yCKZdIxJE-V",
          "slug" : "in1",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "A0OUK5CM9PqCiRUvJ3VpA",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Facility\") == col(\"in1.Facility\")"
          },
          "joinType" : "inner"
        } ],
        "expressions" : [ {
          "_row_id" : "1468710808",
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Plant\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1083173611",
          "target" : "Quantity",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Quantity\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1031639387",
          "target" : "TransactionId",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.TransactionId\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1198488072",
          "target" : "TransactionType",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.TransactionType\")"
          },
          "description" : ""
        }, {
          "_row_id" : "636532110",
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.PartNumber\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1890142584",
          "target" : "Note",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Note\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1566470124",
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Facility\")"
          },
          "description" : ""
        }, {
          "_row_id" : "961167878",
          "target" : "DateTransacted",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.DateTransacted\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1349530478",
          "target" : "TransactedBy",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.TransactedBy\")"
          },
          "description" : ""
        } ],
        "hints" : [ {
          "id" : "HW1FOsluNdvUEsebPOjmd",
          "alias" : "in0",
          "hintType" : "none",
          "propagateColumns" : false
        }, {
          "id" : "dHrqlCwxV9yCKZdIxJE-V",
          "alias" : "in1",
          "hintType" : "none",
          "propagateColumns" : false
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "whereClause" : null,
        "headAlias" : "in0"
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Join",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "65" : {
      "id" : "65",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Facilities",
        "slug" : "Facilities",
        "x" : 2000,
        "y" : 500,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "65_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "65_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Facility\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "57" : {
      "id" : "57",
      "component" : "SchemaTransform",
      "metadata" : {
        "label" : "Transactions",
        "slug" : "Transactions",
        "x" : 620,
        "y" : 2060,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "IwLjCIROf_RqO6tpSvFIB",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "seq",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "57_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "transformations" : [ {
          "AddRule" : {
            "expression" : {
              "format" : "scala",
              "expression" : ""
            },
            "paramErrors" : [ ]
          },
          "DropColumn" : {
            "sourceColumn" : ""
          },
          "kind" : "AddReplaceColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "fileNameArray",
            "expression" : {
              "format" : "python",
              "expression" : "call_spark_fcn(\"directory_listing\", lit(\"X:\\ADW\\Operations\\Material Management\\Material Reconciliation\\Transactions\"), lit(\"\"))"
            }
          }
        }, {
          "AddRule" : {
            "expression" : {
              "format" : "scala",
              "expression" : ""
            },
            "paramErrors" : [ ]
          },
          "DropColumn" : {
            "sourceColumn" : ""
          },
          "kind" : "AddReplaceColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "fileName",
            "expression" : {
              "format" : "python",
              "expression" : "explode(col(\"fileNameArray\"))"
            }
          }
        }, {
          "AddRule" : {
            "expression" : {
              "format" : "scala",
              "expression" : ""
            },
            "paramErrors" : [ ]
          },
          "DropColumn" : {
            "sourceColumn" : "fileNameArray"
          },
          "kind" : "DropColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "",
            "expression" : {
              "format" : "scala",
              "expression" : ""
            }
          }
        }, {
          "AddRule" : {
            "expression" : {
              "format" : "scala",
              "expression" : ""
            },
            "paramErrors" : [ ]
          },
          "DropColumn" : {
            "sourceColumn" : "seq"
          },
          "kind" : "DropColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "",
            "expression" : {
              "format" : "scala",
              "expression" : ""
            }
          }
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "108" : {
      "id" : "108",
      "component" : "Aggregate",
      "metadata" : {
        "label" : "Summarize_108",
        "slug" : "Summarize_108",
        "x" : 2920,
        "y" : 640,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "108_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "OpeningBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "108_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "allIns" : false,
        "doPivot" : false,
        "aggregate" : [ {
          "target" : "OpeningBalance",
          "expression" : {
            "format" : "python",
            "expression" : "sum(col(\"OpeningBalance\"))"
          },
          "description" : ""
        } ],
        "allowSelection" : true,
        "pivotColumn" : null,
        "pivotValues" : [ ],
        "activeTab" : "aggregate",
        "columnsSelector" : [ ],
        "groupBy" : [ {
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Facility\")"
          },
          "description" : ""
        }, {
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Plant\")"
          },
          "description" : ""
        }, {
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"PartNumber\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Aggregate",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "11_createData" : {
      "id" : "11_createData",
      "component" : "Source",
      "metadata" : {
        "label" : "Balances_createData_2",
        "slug" : "Balances_createData",
        "x" : 20,
        "y" : 20,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "CA2WDdb9IKgYPbGqcI1Ge",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/Balances_createData_2"
      }
    },
    "80" : {
      "id" : "80",
      "component" : "Reformat",
      "metadata" : {
        "label" : "PartNumber",
        "slug" : "PartNumber",
        "x" : 2200,
        "y" : 1880,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "80_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "80_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"PartNumber\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "43_inner" : {
      "id" : "43_inner",
      "component" : "Join",
      "metadata" : {
        "label" : "Join_43_inner",
        "slug" : "Join_43_inner",
        "x" : 1680,
        "y" : 820,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "Eq51AcpkeVD6NbDq-Etkq",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WIPOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "BentecOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WarehouseOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Timestamp",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ConsignedOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "egiHiuFGVVCCtQhsklNpM",
          "slug" : "in1",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "gz4yUY7kHMB5QHWrZAm07",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Facility\") == col(\"in1.Facility\")"
          },
          "joinType" : "inner"
        } ],
        "expressions" : [ {
          "_row_id" : "965260735",
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Plant\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1947944013",
          "target" : "Timestamp",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Timestamp\")"
          },
          "description" : ""
        }, {
          "_row_id" : "2019174145",
          "target" : "WIPOnHandBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.WIPOnHandBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1918868904",
          "target" : "BentecOnHandBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.BentecOnHandBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1474882721",
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.PartNumber\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1007667716",
          "target" : "WarehouseOnHandBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.WarehouseOnHandBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "421800327",
          "target" : "ConsignedOnHandBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.ConsignedOnHandBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1996170134",
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Facility\")"
          },
          "description" : ""
        } ],
        "hints" : [ {
          "id" : "Eq51AcpkeVD6NbDq-Etkq",
          "alias" : "in0",
          "hintType" : "none",
          "propagateColumns" : false
        }, {
          "id" : "egiHiuFGVVCCtQhsklNpM",
          "alias" : "in1",
          "hintType" : "none",
          "propagateColumns" : false
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "whereClause" : null,
        "headAlias" : "in0"
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Join",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "106" : {
      "id" : "106",
      "component" : "Source",
      "metadata" : {
        "label" : "SamtecFacilitieswith_2",
        "slug" : "SamtecFacilitieswith",
        "x" : 620,
        "y" : 1180,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "106_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/SamtecFacilitieswith_2"
      }
    },
    "49" : {
      "id" : "49",
      "component" : "Script",
      "metadata" : {
        "label" : "DynamicInput_49",
        "slug" : "DynamicInput_49",
        "x" : 1420,
        "y" : 320,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "49_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "EndDate",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "fileName",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "49_Output",
          "slug" : "out0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WIPOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "BentecOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WarehouseOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Timestamp",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ConsignedOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "\n\n\ndef read_file(file_name):\n    return spark.read.format(\"csv\").option(\"header\", \"true\").load(file_name)\n\ndata_frames = [read_file(row['fileName']) for row in df.select('fileName').collect()]\n\nout0 = reduce(DataFrame.union, data_frames)\n",
        "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> DataFrame:",
        "scriptMethodFooter" : "return out0"
      }
    },
    "88_left" : {
      "id" : "88_left",
      "component" : "Join",
      "metadata" : {
        "label" : "Join_88_left_UnionFullOuter",
        "slug" : "Join_88_left_UnionFullOuter",
        "x" : 3180,
        "y" : 640,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "U4QiShm-cxD96GbsgHXaN",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "OpeningBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "jmH3AfjAKRK_Jd_XSow-G",
          "slug" : "in1",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ClosingBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "a7zBPDKpzvf93lXUGFGdZ",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "format" : "python",
            "expression" : "((col(\"in0.Facility\") == col(\"in1.Facility\")) & (col(\"in0.Plant\") == col(\"in1.Plant\"))) & (col(\"in0.PartNumber\") == col(\"in1.PartNumber\"))"
          },
          "joinType" : "fullouter"
        } ],
        "expressions" : [ {
          "_row_id" : "1797020514",
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Plant\")"
          },
          "description" : ""
        }, {
          "_row_id" : "341305399",
          "target" : "ClosingBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in1.ClosingBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1437355958",
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.PartNumber\")"
          },
          "description" : ""
        }, {
          "_row_id" : "2102384412",
          "target" : "OpeningBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.OpeningBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "2060108038",
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Facility\")"
          },
          "description" : ""
        } ],
        "hints" : [ {
          "id" : "U4QiShm-cxD96GbsgHXaN",
          "alias" : "in0",
          "hintType" : "none",
          "propagateColumns" : false
        }, {
          "id" : "jmH3AfjAKRK_Jd_XSow-G",
          "alias" : "in1",
          "hintType" : "none",
          "propagateColumns" : false
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "whereClause" : null,
        "headAlias" : "in0"
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Join",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "40_fileName" : {
      "id" : "40_fileName",
      "component" : "SchemaTransform",
      "metadata" : {
        "label" : "DynamicInput_40_fileName",
        "slug" : "DynamicInput_40_fileName",
        "x" : 1220,
        "y" : 720,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "vop9g8FENP65unHV8mRtt",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "StartDate",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "dlGmb4JygKEoXNFH00E5i",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "transformations" : [ {
          "AddRule" : {
            "expression" : {
              "format" : "scala",
              "expression" : ""
            },
            "paramErrors" : [ ]
          },
          "DropColumn" : {
            "sourceColumn" : ""
          },
          "kind" : "AddReplaceColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "fileName",
            "expression" : {
              "format" : "python",
              "expression" : "concat(lit(\"X:\\\\adw\\\\operations\\\\material management\\\\material reconciliation\\\\balances\\\\2016-06-01.yxdb\"), col(\"StartDate\"))"
            }
          }
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "39" : {
      "id" : "39",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Dates",
        "slug" : "Dates",
        "x" : 1020,
        "y" : 720,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "39_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "StartDate",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "EndDate",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "39_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "StartDate",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"StartDate\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "17" : {
      "id" : "17",
      "component" : "Reformat",
      "metadata" : {
        "label" : "DatesfromUserInput",
        "slug" : "DatesfromUserInput",
        "x" : 1020,
        "y" : 520,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "17_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "StartDate",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "EndDate",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "17_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "StartDate",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"StartDate\")"
          },
          "description" : ""
        }, {
          "target" : "EndDate",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"EndDate\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "60" : {
      "id" : "60",
      "component" : "Join",
      "metadata" : {
        "label" : "AppendFields_60",
        "slug" : "AppendFields_60",
        "x" : 1220,
        "y" : 2080,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "60_Targets",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "FileName",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "FileDate",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "60_Source",
          "slug" : "in1",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "StartDate",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "EndDate",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "60_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "format" : "python",
            "expression" : "lit(1) == lit(1).cast(IntegerType())"
          },
          "joinType" : "inner"
        } ],
        "expressions" : [ {
          "_row_id" : "95673212",
          "target" : "FileName",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.FileName\")"
          },
          "description" : ""
        }, {
          "_row_id" : "857152841",
          "target" : "FileDate",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.FileDate\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1961738115",
          "target" : "StartDate",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in1.StartDate\")"
          },
          "description" : ""
        }, {
          "_row_id" : "955312788",
          "target" : "EndDate",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in1.EndDate\")"
          },
          "description" : ""
        } ],
        "hints" : [ {
          "id" : "60_Targets",
          "alias" : "in0",
          "hintType" : "none",
          "propagateColumns" : false
        }, {
          "id" : "60_Source",
          "alias" : "in1",
          "hintType" : "none",
          "propagateColumns" : false
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "whereClause" : null,
        "headAlias" : "in0"
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Join",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "14" : {
      "id" : "14",
      "component" : "Aggregate",
      "metadata" : {
        "label" : "Summarize_14",
        "slug" : "Summarize_14",
        "x" : 1020,
        "y" : 20,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "14_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "FileName",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "FileDate",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "14_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "allIns" : false,
        "doPivot" : false,
        "aggregate" : [ {
          "target" : "FirstDate",
          "expression" : {
            "format" : "python",
            "expression" : "min(col(\"FileDate\"))"
          },
          "description" : ""
        }, {
          "target" : "LastDate",
          "expression" : {
            "format" : "python",
            "expression" : "max(col(\"FileDate\"))"
          },
          "description" : ""
        } ],
        "allowSelection" : true,
        "pivotColumn" : null,
        "pivotValues" : [ ],
        "activeTab" : "aggregate",
        "columnsSelector" : [ ],
        "groupBy" : [ ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Aggregate",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "96" : {
      "id" : "96",
      "component" : "Script",
      "metadata" : {
        "label" : "MultiRowFormula_96",
        "slug" : "MultiRowFormula_96",
        "x" : 4180,
        "y" : 1660,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "96_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Quantity",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Note",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ClosingBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactedBy",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DateTransacted",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionId",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "OpeningBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "RollingBalance",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "96_Output",
          "slug" : "out0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Quantity",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Note",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ClosingBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "RollingBalance",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactedBy",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DateTransacted",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionId",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "OpeningBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "\n\n\n\ndef calculate(iterator):\n    RollingBalance_lag1 = 0.0\n    for row in iterator:\n        OpeningBalance = row[\"OpeningBalance\"]\n\t\tQuantity = row[\"Quantity\"]\n\t\tRollingBalance = row[\"RollingBalance\"]\n\n        RollingBalance_new = OpeningBalance + Quantity if ((not RollingBalance_lag1 == None) and isnull(RollingBalance_lag1)) else RollingBalance_lag1 + Quantity\n\n        RollingBalance_lag1 = RollingBalance_new\n        newRow = list(row)\n        newRow[row.__fields__.index(\"RollingBalance\") ] = RollingBalance_new\n        yield newRow\n\n\n\nresultRDD = in0.repartition(col(\"Facility\"),col(\"Plant\"),col(\"PartNumber\")).sortWithinPartitions(col(\"Facility\"),col(\"Plant\"),col(\"PartNumber\")).rdd.mapPartitions(calculate)\n\nout0 = spark.createDataFrame(resultRDD, in0.schema)\n\n\n\n",
        "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> DataFrame:",
        "scriptMethodFooter" : "return out0"
      }
    },
    "95" : {
      "id" : "95",
      "component" : "OrderBy",
      "metadata" : {
        "label" : "Sort_95",
        "slug" : "Sort_95",
        "x" : 3980,
        "y" : 1660,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "95_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Quantity",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Note",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ClosingBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactedBy",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DateTransacted",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionId",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "OpeningBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "RollingBalance",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "95_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "orders" : [ {
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Facility\")"
          },
          "sortType" : "asc"
        }, {
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Plant\")"
          },
          "sortType" : "asc"
        }, {
          "expression" : {
            "format" : "python",
            "expression" : "col(\"PartNumber\")"
          },
          "sortType" : "asc"
        }, {
          "expression" : {
            "format" : "python",
            "expression" : "col(\"DateTransacted\")"
          },
          "sortType" : "asc"
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/OrderBy",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "58" : {
      "id" : "58",
      "component" : "SchemaTransform",
      "metadata" : {
        "label" : "DatefromFileName",
        "slug" : "DatefromFileName",
        "x" : 1020,
        "y" : 2060,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "58_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "FileName",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "58_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "transformations" : [ {
          "AddRule" : {
            "expression" : {
              "format" : "scala",
              "expression" : ""
            },
            "paramErrors" : [ ]
          },
          "DropColumn" : {
            "sourceColumn" : ""
          },
          "kind" : "AddReplaceColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "FileDate",
            "expression" : {
              "format" : "python",
              "expression" : "regexp_replace(col(\"FileName\"), \".yxdb\", \"\")"
            }
          }
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "53" : {
      "id" : "53",
      "component" : "SchemaTransform",
      "metadata" : {
        "label" : "ClosingBalance",
        "slug" : "ClosingBalance",
        "x" : 2200,
        "y" : 740,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "53_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Timestamp",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WIPOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "BentecOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WarehouseOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ConsignedOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "53_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "transformations" : [ {
          "AddRule" : {
            "expression" : {
              "format" : "scala",
              "expression" : ""
            },
            "paramErrors" : [ ]
          },
          "DropColumn" : {
            "sourceColumn" : ""
          },
          "kind" : "AddReplaceColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "ClosingBalance",
            "expression" : {
              "format" : "python",
              "expression" : "(((col(\"WarehouseOnHandBalance\") + col(\"BentecOnHandBalance\")) + col(\"WIPOnHandBalance\")) + col(\"ConsignedOnHandBalance\"))"
            }
          }
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "42" : {
      "id" : "42",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Facilities",
        "slug" : "Facilities",
        "x" : 1420,
        "y" : 1020,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "42_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "42_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Facility\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "109" : {
      "id" : "109",
      "component" : "Aggregate",
      "metadata" : {
        "label" : "Summarize_109",
        "slug" : "Summarize_109",
        "x" : 2920,
        "y" : 440,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "109_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ClosingBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "109_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "allIns" : false,
        "doPivot" : false,
        "aggregate" : [ {
          "target" : "ClosingBalance",
          "expression" : {
            "format" : "python",
            "expression" : "sum(col(\"ClosingBalance\"))"
          },
          "description" : ""
        } ],
        "allowSelection" : true,
        "pivotColumn" : null,
        "pivotValues" : [ ],
        "activeTab" : "aggregate",
        "columnsSelector" : [ ],
        "groupBy" : [ {
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Facility\")"
          },
          "description" : ""
        }, {
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Plant\")"
          },
          "description" : ""
        }, {
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"PartNumber\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Aggregate",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "27" : {
      "id" : "27",
      "component" : "SchemaTransform",
      "metadata" : {
        "label" : "AdvanceEndDatetoNextDate",
        "slug" : "AdvanceEndDatetoNextDate",
        "x" : 620,
        "y" : 440,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "27_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "StartDate",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "EndDate",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "27_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "transformations" : [ {
          "AddRule" : {
            "expression" : {
              "format" : "scala",
              "expression" : ""
            },
            "paramErrors" : [ ]
          },
          "DropColumn" : {
            "sourceColumn" : ""
          },
          "kind" : "AddReplaceColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "EndDate",
            "expression" : {
              "format" : "python",
              "expression" : "expr(\"date_add(EndDate, 1)\")"
            }
          }
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "70" : {
      "id" : "70",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Dates",
        "slug" : "Dates",
        "x" : 1020,
        "y" : 980,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "70_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "StartDate",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "EndDate",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "70_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "StartDate",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"StartDate\")"
          },
          "description" : ""
        }, {
          "target" : "EndDate",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"EndDate\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "86" : {
      "id" : "86",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Transactions",
        "slug" : "Transactions",
        "x" : 3180,
        "y" : 1720,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "86_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Quantity",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionId",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Note",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DateTransacted",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactedBy",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "86_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Facility\")"
          },
          "description" : ""
        }, {
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"PartNumber\")"
          },
          "description" : ""
        }, {
          "target" : "TransactedBy",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"TransactedBy\")"
          },
          "description" : ""
        }, {
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Plant\")"
          },
          "description" : ""
        }, {
          "target" : "DateTransacted",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"DateTransacted\")"
          },
          "description" : ""
        }, {
          "target" : "Note",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Note\")"
          },
          "description" : ""
        }, {
          "target" : "TransactionType",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"TransactionType\")"
          },
          "description" : ""
        }, {
          "target" : "TransactionId",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"TransactionId\")"
          },
          "description" : ""
        }, {
          "target" : "Quantity",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Quantity\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "49_fileName" : {
      "id" : "49_fileName",
      "component" : "SchemaTransform",
      "metadata" : {
        "label" : "DynamicInput_49_fileName",
        "slug" : "DynamicInput_49_fileName",
        "x" : 1220,
        "y" : 320,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "g9Q7cOCTy3unQPmtLJaNh",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "EndDate",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "VtibWpESshDcPylWGLu7Z",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "transformations" : [ {
          "AddRule" : {
            "expression" : {
              "format" : "scala",
              "expression" : ""
            },
            "paramErrors" : [ ]
          },
          "DropColumn" : {
            "sourceColumn" : ""
          },
          "kind" : "AddReplaceColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "fileName",
            "expression" : {
              "format" : "python",
              "expression" : "concat(lit(\"X:\\\\adw\\\\operations\\\\material management\\\\material reconciliation\\\\balances\\\\2016-06-01.yxdb\"), col(\"EndDate\"))"
            }
          }
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "92" : {
      "id" : "92",
      "component" : "SchemaTransform",
      "metadata" : {
        "label" : "Formula_92",
        "slug" : "Formula_92",
        "x" : 3780,
        "y" : 1660,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "92_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Quantity",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Note",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ClosingBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactedBy",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DateTransacted",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionId",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "OpeningBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "92_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "transformations" : [ {
          "AddRule" : {
            "expression" : {
              "format" : "scala",
              "expression" : ""
            },
            "paramErrors" : [ ]
          },
          "DropColumn" : {
            "sourceColumn" : ""
          },
          "kind" : "AddReplaceColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "RollingBalance",
            "expression" : {
              "format" : "python",
              "expression" : "lit(\"Null()\")"
            }
          }
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "101" : {
      "id" : "101",
      "component" : "Reformat",
      "metadata" : {
        "label" : "AccountingTransactionTypes",
        "slug" : "AccountingTransactionTypes",
        "x" : 4380,
        "y" : 1860,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "101_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Base Transaction Type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Accounting Transaction Type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "101_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "Base Transaction Type",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"`Base Transaction Type`\")"
          },
          "description" : ""
        }, {
          "target" : "Accounting Transaction Type",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"`Accounting Transaction Type`\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "97" : {
      "id" : "97",
      "component" : "Reformat",
      "metadata" : {
        "label" : "AlteryxSelect_97",
        "slug" : "AlteryxSelect_97",
        "x" : 4380,
        "y" : 1660,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "97_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Quantity",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Note",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ClosingBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "RollingBalance",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactedBy",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DateTransacted",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionId",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "OpeningBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "97_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Facility\")"
          },
          "description" : ""
        }, {
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"PartNumber\")"
          },
          "description" : ""
        }, {
          "target" : "TransactedBy",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"TransactedBy\")"
          },
          "description" : ""
        }, {
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Plant\")"
          },
          "description" : ""
        }, {
          "target" : "DateTransacted",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"DateTransacted\")"
          },
          "description" : ""
        }, {
          "target" : "Note",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Note\")"
          },
          "description" : ""
        }, {
          "target" : "ClosingBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"ClosingBalance\")"
          },
          "description" : ""
        }, {
          "target" : "TransactionType",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"TransactionType\")"
          },
          "description" : ""
        }, {
          "target" : "TransactionId",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"TransactionId\")"
          },
          "description" : ""
        }, {
          "target" : "Quantity",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Quantity\")"
          },
          "description" : ""
        }, {
          "target" : "RollingBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"RollingBalance\")"
          },
          "description" : ""
        }, {
          "target" : "OpeningBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"OpeningBalance\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "29" : {
      "id" : "29",
      "component" : "SchemaTransform",
      "metadata" : {
        "label" : "PreviousQuarterClosingDate",
        "slug" : "PreviousQuarterClosingDate",
        "x" : 820,
        "y" : 420,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "29_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "StartDate",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "EndDate",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "frSUkgitgC2DvPZP06pTO",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "transformations" : [ {
          "AddRule" : {
            "expression" : {
              "format" : "scala",
              "expression" : ""
            },
            "paramErrors" : [ ]
          },
          "DropColumn" : {
            "sourceColumn" : ""
          },
          "kind" : "AddReplaceColumn",
          "RenameColumn" : {
            "sourceColumn" : "",
            "targetColumn" : ""
          },
          "AddReplaceColumn" : {
            "sourceColumn" : "PreviousQuarterClosingDate",
            "expression" : {
              "format" : "python",
              "expression" : "when(array_contains(array(lit(2), lit(5), lit(8), lit(11)), date_format(col(\"EndDate\"), \"MM\").cast(IntegerType()).cast(DoubleType())), add_months(col(\"EndDate\"), lit(-1))).when(array_contains(array(lit(3), lit(6), lit(9), lit(12)), date_format(col(\"EndDate\"), \"MM\").cast(IntegerType()).cast(DoubleType())), add_months(col(\"EndDate\"), lit(-2))).otherwise(add_months(col(\"EndDate\"), lit(-3)))"
            }
          }
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/SchemaTransform",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "41" : {
      "id" : "41",
      "component" : "Reformat",
      "metadata" : {
        "label" : "AlteryxSelect_41",
        "slug" : "AlteryxSelect_41",
        "x" : 2520,
        "y" : 640,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "41_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Timestamp",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WIPOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "BentecOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WarehouseOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ConsignedOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "OpeningBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "41_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Facility\")"
          },
          "description" : ""
        }, {
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Plant\")"
          },
          "description" : ""
        }, {
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"PartNumber\")"
          },
          "description" : ""
        }, {
          "target" : "OpeningBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"OpeningBalance\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "105" : {
      "id" : "105",
      "component" : "Target",
      "metadata" : {
        "label" : "PerpetualInventoryDe_2",
        "slug" : "PerpetualInventoryDe",
        "x" : 5180,
        "y" : 1760,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "105_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "OpeningBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ClosingBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionId",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "SystemType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "AccountingType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Quantity",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "RollingBalance",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DateTransacted",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactedBy",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Note",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "datasetId" : "datasets/PerpetualInventoryDe_2"
      }
    },
    "63" : {
      "id" : "63",
      "component" : "Script",
      "metadata" : {
        "label" : "DynamicInput_63",
        "slug" : "DynamicInput_63",
        "x" : 2200,
        "y" : 2080,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "63_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "FileDate",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "fileName",
              "type" : "string",
              "nullable" : false,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "63_Output",
          "slug" : "out0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Quantity",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Note",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactedBy",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DateTransacted",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionId",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : true,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "script" : "\n\n\ndef read_file(file_name):\n    return spark.read.format(\"csv\").option(\"header\", \"true\").load(file_name)\n\ndata_frames = [read_file(row['fileName']) for row in df.select('fileName').collect()]\n\nout0 = reduce(DataFrame.union, data_frames)\n",
        "scriptMethodHeader" : "def Script(spark: SparkSession, in0: DataFrame) -> DataFrame:",
        "scriptMethodFooter" : "return out0"
      }
    },
    "74" : {
      "id" : "74",
      "component" : "Reformat",
      "metadata" : {
        "label" : "PartNumber",
        "slug" : "PartNumber",
        "x" : 1680,
        "y" : 1420,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "74_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "74_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"PartNumber\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "85" : {
      "id" : "85",
      "component" : "Reformat",
      "metadata" : {
        "label" : "ClosingBalance",
        "slug" : "ClosingBalance",
        "x" : 2720,
        "y" : 440,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "85_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ClosingBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "85_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Facility\")"
          },
          "description" : ""
        }, {
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"Plant\")"
          },
          "description" : ""
        }, {
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"PartNumber\")"
          },
          "description" : ""
        }, {
          "target" : "ClosingBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"ClosingBalance\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "76_inner" : {
      "id" : "76_inner",
      "component" : "Join",
      "metadata" : {
        "label" : "Join_76_inner",
        "slug" : "Join_76_inner",
        "x" : 2000,
        "y" : 740,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "IpAOesq6xw-8-Q27NSwoQ",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Timestamp",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WIPOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "BentecOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "WarehouseOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ConsignedOnHandBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "3GgHLqhZ6Vup4HzfTlHBj",
          "slug" : "in1",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "nzE7ip1G71E7qBV4nhD4B",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.PartNumber\") == col(\"in1.PartNumber\")"
          },
          "joinType" : "inner"
        } ],
        "expressions" : [ {
          "_row_id" : "1310735641",
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Plant\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1561243242",
          "target" : "Timestamp",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Timestamp\")"
          },
          "description" : ""
        }, {
          "_row_id" : "256978970",
          "target" : "WIPOnHandBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.WIPOnHandBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1322916360",
          "target" : "BentecOnHandBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.BentecOnHandBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "2115451281",
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.PartNumber\")"
          },
          "description" : ""
        }, {
          "_row_id" : "4729895",
          "target" : "WarehouseOnHandBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.WarehouseOnHandBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1488821775",
          "target" : "ConsignedOnHandBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.ConsignedOnHandBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1779792237",
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Facility\")"
          },
          "description" : ""
        } ],
        "hints" : [ {
          "id" : "IpAOesq6xw-8-Q27NSwoQ",
          "alias" : "in0",
          "hintType" : "none",
          "propagateColumns" : false
        }, {
          "id" : "3GgHLqhZ6Vup4HzfTlHBj",
          "alias" : "in1",
          "hintType" : "none",
          "propagateColumns" : false
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "whereClause" : null,
        "headAlias" : "in0"
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Join",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "28" : {
      "id" : "28",
      "component" : "Reformat",
      "metadata" : {
        "label" : "AlteryxSelect_28",
        "slug" : "AlteryxSelect_28",
        "x" : 820,
        "y" : 620,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "28_Input",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "StartDate",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "EndDate",
              "type" : "date",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "28_Output",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "target" : "StartDate",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"StartDate\")"
          },
          "description" : ""
        }, {
          "target" : "EndDate",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"EndDate\")"
          },
          "description" : ""
        } ]
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Reformat",
        "projectName" : "ProphecySparkBasicsPython"
      }
    },
    "99_inner" : {
      "id" : "99_inner",
      "component" : "Join",
      "metadata" : {
        "label" : "Join_99_inner",
        "slug" : "Join_99_inner",
        "x" : 4580,
        "y" : 1760,
        "phase" : 0,
        "cache" : false,
        "detailedStats" : false,
        "isImported" : true
      },
      "ports" : {
        "inputs" : [ {
          "id" : "fUjpbRWK1ND4EWyfyyxvg",
          "slug" : "in0",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Facility",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "PartNumber",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactedBy",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Plant",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "DateTransacted",
              "type" : "timestamp",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Note",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "ClosingBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionType",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "TransactionId",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Quantity",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "RollingBalance",
              "type" : "integer",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "OpeningBalance",
              "type" : "double",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        }, {
          "id" : "3TUPB-5K2OhoM8BMunRbq",
          "slug" : "in1",
          "schema" : {
            "type" : "struct",
            "fields" : [ {
              "name" : "Base Transaction Type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            }, {
              "name" : "Accounting Transaction Type",
              "type" : "string",
              "nullable" : true,
              "metadata" : {
                "description" : "",
                "mappings" : [ ],
                "tags" : [ ]
              }
            } ]
          },
          "isStreaming" : false
        } ],
        "outputs" : [ {
          "id" : "_B-p6q1qF02yJJrK8Tc7l",
          "slug" : "out0"
        } ],
        "selectedInputFields" : [ ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.TransactionType\") == col(\"in1.`Base Transaction Type`\")"
          },
          "joinType" : "inner"
        } ],
        "expressions" : [ {
          "_row_id" : "1989521003",
          "target" : "Plant",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Plant\")"
          },
          "description" : ""
        }, {
          "_row_id" : "487922495",
          "target" : "Quantity",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Quantity\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1481959985",
          "target" : "ClosingBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.ClosingBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "648758613",
          "target" : "TransactionId",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.TransactionId\")"
          },
          "description" : ""
        }, {
          "_row_id" : "813212608",
          "target" : "TransactionType",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.TransactionType\")"
          },
          "description" : ""
        }, {
          "_row_id" : "453154244",
          "target" : "Accounting Transaction Type",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in1.`Accounting Transaction Type`\")"
          },
          "description" : ""
        }, {
          "_row_id" : "253973354",
          "target" : "RollingBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.RollingBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "1405989040",
          "target" : "PartNumber",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.PartNumber\")"
          },
          "description" : ""
        }, {
          "_row_id" : "348223954",
          "target" : "Note",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Note\")"
          },
          "description" : ""
        }, {
          "_row_id" : "926229678",
          "target" : "OpeningBalance",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.OpeningBalance\")"
          },
          "description" : ""
        }, {
          "_row_id" : "323143170",
          "target" : "Facility",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.Facility\")"
          },
          "description" : ""
        }, {
          "_row_id" : "492633555",
          "target" : "DateTransacted",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.DateTransacted\")"
          },
          "description" : ""
        }, {
          "_row_id" : "114394830",
          "target" : "TransactedBy",
          "expression" : {
            "format" : "python",
            "expression" : "col(\"in0.TransactedBy\")"
          },
          "description" : ""
        } ],
        "hints" : [ {
          "id" : "fUjpbRWK1ND4EWyfyyxvg",
          "alias" : "in0",
          "hintType" : "none",
          "propagateColumns" : false
        }, {
          "id" : "3TUPB-5K2OhoM8BMunRbq",
          "alias" : "in1",
          "hintType" : "none",
          "propagateColumns" : false
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "whereClause" : null,
        "headAlias" : "in0"
      },
      "componentInfo" : {
        "gemId" : "gitUri=http://gitserver:3000/DxEheDCJ_team_5751/DxEheDCJ_project_12654.git&subPath=&tag=0.2.25&projectSubscriptionProjectId=12654&path=gems/Join",
        "projectName" : "ProphecySparkBasicsPython"
      }
    }
  },
  "ports" : {
    "inputs" : [ ],
    "outputs" : [ ],
    "selectedInputFields" : [ ],
    "isCustomOutputSchema" : false,
    "autoUpdateOnRun" : false
  }
}